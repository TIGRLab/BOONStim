singularity {

    autoMounts=true
    enabled=true

}

// BIN DIRECTORY
params.bin = "/projects/jjeyachandra/BOONStim/pipeline/dsl2/bin"

// COIL TO USE
params.coil = "/projects/jjeyachandra/simnibs/ccd-files/Magstim_70mm_Fig8.nii.gz"

// CIFTIFY SPEC
params.simg = "/archive/code/containers/FMRIPREP_CIFTIFY/tigrlab_fmriprep_ciftify_1.3.0.post2-2.3.1-2019-04-04-8ebe3500bebf.img"
params.ciftify_invocation = "/projects/jjeyachandra/boutiques_jsons/invocations/fmriprep_ciftify-1.3.0.post2-2.3.1_invocation.json"
params.ciftify_descriptor = "/projects/jjeyachandra/boutiques_jsons/descriptors/fmriprep_ciftify-1.3.0.post2-2.3.1.json"

// FMRIPREP SPEC
params.anat_invocation = "/projects/jjeyachandra/BOONStim/pipeline/invocations/fmriprep_anat_wf.json"
params.anat_descriptor = "/projects/jjeyachandra/boutiques_jsons/descriptors/fmriprep-1.3.2.json"

// FREESURFER SPEC
params.freesurfer = '/projects/jjeyachandra/BOONStim/containers/freesurfer_6.0.1/freesurfer_expert_6.0.1.simg'
params.license="/opt/quarantine/freesurfer/6.0.0/build/"

// CONNECTOME WORKBENCH SPEC
params.connectome = '/projects/jjeyachandra/BOONStim/containers/connectome_workbench/connectome_workbench_v1.0-2019-06-05-bbdb3be76afe.simg'

// BIDS-APPS SPEC
params.work = "/tmp/"

// ATLASES
params.atlas = "/projects/jjeyachandra/BOONStim/pipeline/templates/"

// MSM
params.msm = "/projects/jjeyachandra/BOONStim/pipeline/msm_conf/"

// Custom user-defined weight function configuration
includeConfig "../user/calculate_mentalizing_weightfunc.nf.config"
params.weightworkflow = "/projects/jjeyachandra/BOONStim/pipeline/dsl2/user/calculate_mentalizing_weightfunc.nf"

// Caching directory
cacheDir = "/scratch/jjeyachandra/BOONStim/cache"

//Local only for now
process {
    withName: fmriprep_anat {
        
        storeDir = "$cacheDir/fmriprep_anat"
        executor = "local"
        errorStrategy = 'retry'
        maxRetries = 3
        queue = "high-moby"
        clusterOptions = "--time=36:00:00 --mem-per-cpu=2048\
         --cpus-per-task=4 --job-name boonstim_ciftify\
         --nodes=1"
    }
    
    withName: ciftify{
        storeDir = "$cacheDir/ciftify"
        executor = "local"
        errorStrategy = 'retry'
        maxRetries = 3
        queue = "high-moby"
        clusterOptions = "--time=36:00:00 --mem-per-cpu=2048\
         --cpus-per-task=4 --job-name boonstim_ciftify\
         --nodes=1"
    }

    withName: mri2mesh{
        storeDir = "$cacheDir/mri2mesh"
        container = "/projects/jjeyachandra/BOONStim/containers/simnibs_3.0/mri2mesh_v3.0_v0.2-2019-06-24-1dfbbefb361d.simg"
        executor = "local"
        errorStrategy = 'retry'
        maxRetries = 3
        queue = 'high-moby'
        clusterOptions = "--time=36:00:00 --mem-per-cpu=2048\
         --cpus-per-task=4 --job-name boonstim_ciftify\
         --nodes=1"
    }

    withName: msm_sulc{
        storeDir = "$cacheDir/msm"
    }
    
    withName: update_msh{ storeDir = "$cacheDir/update_msh" }
    withName: smooth_img{ storeDir = "$cacheDir/smooth_img" }
    withName: tetrahedral_projection{ storeDir = "$cacheDir/tetrahedral_projection" }
    withName: optimize_coil { storeDir = "$cacheDir/optimize_coil" }

    withLabel: ciftify{
        container = "/archive/code/containers/FMRIPREP_CIFTIFY/tigrlab_fmriprep_ciftify_1.3.2-2.3.2-2019-06-07-ba20178606c2.simg"
        executor = 'local'
    }

    withLabel: freesurfer{
        container = '/projects/jjeyachandra/BOONStim/containers/freesurfer_6.0.1/freesurfer_expert_6.0.1.simg'
        executor = 'local'
    }

    withLabel: connectome{
        container = '/projects/jjeyachandra/BOONStim/containers/connectome_workbench/connectome_workbench_v1.0-2019-06-05-bbdb3be76afe.simg'
        executor = 'local'
    }

    withLabel: numpy{
        container ="/projects/jjeyachandra/BOONStim/containers/rtms_bayesian/rtms_bayesian_v0.4-2019-09-09-e99bae9f511b.simg"
        executor = "local"

    }



}

